// ==UserScript==
// @name         Nitro Type Race Exploit
// @version      1.0.2
// @description  Race with your regular WPM in the 5wpm speed zone.
// @author       Ray Adams
// @match        *://*.nitrotype.com/race
// @grant        none
// ==/UserScript==

/*************************************

         Limitized/Nitro-EXP/...
    .../Ray's Scripts/race.user.js
            Jun 19, 2020
      
         PATCHED JULY 2020
      
**************************************/

// With nitros, races take between 4 and 7 seconds.

(function() {
    'use strict';

    function getCookie(name) {
        var value = "; " + document.cookie;
        var parts = value.split("; " + name + "=");
        if (parts.length == 2) return parts.pop().split(";").shift();
    };

    var uhash = getCookie('ntuserrem');
    var encoded_uhash = encodeURI(uhash);

    var int = setInterval(async function() {
        var b = document.getElementsByClassName('btn btn--primary btn--fw btn--pulse animate--iconSlam')[0];

        if (b !== null && b !== undefined) {

            await fetch("https://www.nitrotype.com/api/race/save-qualifying", {
                "credentials": "include",
                "headers": {
                    "Accept": "application/json, text/plain, */*",
                    "Accept-Language": "en-US,en;q=0.5",
                    "Prefer": "safe",
                    "Content-Type": "application/x-www-form-urlencoded"
                },
                "referrer": "https://www.nitrotype.com/garage",
                "body": "carID=15&speed=5&uhash=" + encoded_uhash,
                "method": "POST",
                "mode": "cors"
            });

            location.reload(); // Slightly faster than b.click();
            clearInterval(int);

        }

    }, 100);

})();
